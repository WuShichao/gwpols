(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45495,       1344]
NotebookOptionsPosition[     39903,       1242]
NotebookOutlinePosition[     40295,       1258]
CellTagsIndexPosition[     40252,       1255]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Spin-weighted spherical harmonics", "Section",
 CellChangeTimes->{{3.865069529633814*^9, 3.865069535311661*^9}, 
   3.8650703208667173`*^9},ExpressionUUID->"c24cfee6-221e-468b-9392-\
19d6a58507ee"],

Cell["The spin-weighted spherical harmonics are defined by", "Text",
 CellChangeTimes->{{3.865069512141127*^9, 
  3.865069521760769*^9}},ExpressionUUID->"68d761c8-5fbc-4aec-b2ca-\
e7f793cd1e73"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Y", "[", 
    RowBox[{"s_", ",", "l_", ",", "m_", ",", "\[Theta]_", ",", "\[Phi]_"}], 
    "]"}], ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], "m"], 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"l", "+", "m"}], ")"}], "!"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"l", "-", "m"}], ")"}], "!"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "l"}], "+", "1"}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"l", "+", "s"}], ")"}], "!"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"l", "-", "s"}], ")"}], "!"}], "4", "\[Pi]"}], ")"}]}], 
         ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "/", "2"}], "]"}], ")"}], 
        RowBox[{"2", "l"}]], 
       RowBox[{
        SubsuperscriptBox["\[Sum]", 
         RowBox[{"r", "=", "0"}], 
         RowBox[{"l", "-", "s"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Binomial", "[", 
           RowBox[{
            RowBox[{"l", "-", "s"}], ",", "r"}], "]"}], 
          RowBox[{"Binomial", "[", 
           RowBox[{
            RowBox[{"l", "+", "s"}], ",", 
            RowBox[{"r", "+", "s", "-", "m"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"l", "-", "r", "-", "s"}]], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Phi]"}]], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Cot", "[", 
             RowBox[{"\[Theta]", "/", "2"}], "]"}], ")"}], 
           RowBox[{
            RowBox[{"2", "r"}], "+", "s", "-", "m"}]]}], ")"}]}]}], ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
         RowBox[{"\[Theta]", "\[Element]", "Reals"}]}], "}"}]}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[136]:=",ExpressionUUID->"74cf56f8-cd54-45ac-8c67-9c48f263b519"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Y", "[", 
  RowBox[{
   RowBox[{"-", "2"}], ",", "2", ",", "2", ",", "\[Theta]", ",", "\[Phi]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.865069791807616*^9, 3.865069801624522*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"04b7e5d1-ea96-4d97-911a-fece8a5f3ba2"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
  SqrtBox[
   FractionBox["5", "\[Pi]"]], " ", 
  SuperscriptBox[
   RowBox[{"Cos", "[", 
    FractionBox["\[Theta]", "2"], "]"}], "4"]}]], "Output",
 CellChangeTimes->{3.8650698018914347`*^9},
 CellLabel->
  "Out[165]=",ExpressionUUID->"d6096972-5bdd-437b-80c9-b48b02e0030d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Identities", "Subsection",
 CellChangeTimes->{{3.8650695527599163`*^9, 
  3.865069554505163*^9}},ExpressionUUID->"43e3b16f-7276-4e14-94e2-\
5a36963e6630"],

Cell[TextData[{
 "Check some identities. One of the most useful ones is\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["", "s"], 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["Y", "lm"], "*"], "(", 
      RowBox[{
       RowBox[{"\[Pi]", "-", "\[Theta]"}], ",", 
       RowBox[{"\[Phi]", "+", "\[Pi]"}]}], ")"}]}], "=", 
    RowBox[{
     SubscriptBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"l", "+", "m"}]], "s"], 
     RowBox[{
      SubscriptBox["Y", 
       RowBox[{"l", "-", "m"}]], "(", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "78f89da6-3591-4cf7-85bc-d9c37f0b6b64"]
}], "Text",
 CellChangeTimes->{{3.8650695084673967`*^9, 3.865069525733712*^9}, {
  3.86506956102139*^9, 
  3.865069711523163*^9}},ExpressionUUID->"634825e3-4b70-4a8a-bc29-\
4663203d17ec"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{"Y", "[", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "\[ScriptL]", ",", "m", ",", 
           RowBox[{"\[Pi]", "-", "\[Theta]"}], ",", 
           RowBox[{"\[Phi]", "+", "\[Pi]"}]}], "]"}], "]"}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{"\[ScriptL]", "+", "m"}], ")"}]}], 
         RowBox[{"Y", "[", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "\[ScriptL]", ",", 
           RowBox[{"-", "m"}], ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}]}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Element", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[ScriptL]", ",", "m"}], "}"}], ",", "Integers"}], "]"}],
          ",", 
         RowBox[{"0", "<=", "\[Phi]", "<=", 
          RowBox[{"2", "Pi"}]}], ",", 
         RowBox[{"0", "<", "\[Theta]", "<", "Pi"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"-", "\[ScriptL]"}], ",", "\[ScriptL]"}], "}"}]}], "]"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"\[ScriptL]", ",", "0", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.86502460486585*^9, 3.865024668007707*^9}, {
   3.865024717933301*^9, 3.865024795431872*^9}, {3.865024851297359*^9, 
   3.865024870410378*^9}, {3.865024904609222*^9, 3.8650249065213614`*^9}, {
   3.865024957875951*^9, 3.865024988564584*^9}, {3.865069068442101*^9, 
   3.865069154647193*^9}, {3.8650692165150013`*^9, 3.8650692714093*^9}, {
   3.865069309251566*^9, 3.865069388599864*^9}, 
   3.865069453908051*^9},ExpressionUUID->"78d0ac19-4bbe-4727-b3be-\
0afd27f82bc4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.865069391786244*^9},
 CellLabel->
  "Out[161]=",ExpressionUUID->"736162cd-7128-4686-8792-8c5d138fafee"]
}, Open  ]],

Cell[TextData[{
 "Note that, because the dependence on ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "9bd343ad-48db-4aaa-af07-79438d7ce647"],
 " is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["", "s"], 
     RowBox[{
      SubscriptBox["Y", "lm"], "(", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}]}], "\[Proportional]", " ", 
    RowBox[{"exp", "(", 
     RowBox[{"i", " ", "m", " ", "\[Phi]"}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"4b29e8f8-f4d6-4f89-bd7f-244ebdfdbb1c"],
 ", the factor of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], "m"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "550e0add-4638-43b2-9077-d790d42a143d"],
 " cancels with the ",
 Cell[BoxData[
  FormBox["\[Pi]", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "be85a0b7-f943-4288-ad1c-562c49479542"],
 " shift in the argument on the  LHS by\n\t ",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "m"], "s"], 
     RowBox[{
      SubscriptBox[
       SuperscriptBox["Y", "*"], "lm"], "(", 
      RowBox[{"\[Theta]", ",", 
       RowBox[{"\[Phi]", "+", "\[Pi]"}]}], ")"}]}], "=", " ", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "m"], "s"], 
      RowBox[{
       SubscriptBox[
        SuperscriptBox[
         OverscriptBox["Y", "^"], "*"], "lm"], "(", "\[Theta]", ")"}], " ", 
      SuperscriptBox["e", 
       RowBox[{
        RowBox[{"-", "i"}], " ", 
        RowBox[{"m", "(", 
         RowBox[{"\[Phi]", "+", "\[Pi]"}], ")"}]}]]}], "=", 
     RowBox[{
      SubscriptBox[
       SuperscriptBox["e", 
        RowBox[{"i", " ", "m", " ", "\[Pi]", " "}]], "s"], 
      RowBox[{
       SubscriptBox[
        SuperscriptBox[
         OverscriptBox["Y", "^"], "*"], "lm"], "(", "\[Theta]", ")"}], " ", 
      SuperscriptBox["e", 
       RowBox[{
        RowBox[{"-", "i"}], " ", 
        RowBox[{"m", "(", 
         RowBox[{"\[Phi]", "+", "\[Pi]"}], ")"}]}]]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"\t\t\t\t", 
    RowBox[{
     SubscriptBox[
      RowBox[{"=", " "}], "s"], 
     RowBox[{
      SubscriptBox[
       SuperscriptBox[
        OverscriptBox["Y", "^"], "*"], "lm"], "(", "\[Theta]", ")"}], " ", 
     SuperscriptBox["e", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "i"}], " ", 
        RowBox[{"m", "(", 
         RowBox[{"\[Phi]", "+", "\[Pi]"}], ")"}]}], " ", "+", " ", 
       "m\[Pi]"}]], 
     SubscriptBox[
      RowBox[{"=", " "}], "s"], 
     RowBox[{
      SubscriptBox[
       SuperscriptBox[
        OverscriptBox["Y", "^"], "*"], "lm"], "(", "\[Theta]", ")"}], " ", 
     SuperscriptBox["e", 
      RowBox[{
       RowBox[{"-", "i"}], " ", "m", " ", "\[Phi]"}]]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"\t\t\t\t", 
    RowBox[{
     SubscriptBox[
      RowBox[{"=", " "}], "s"], 
     RowBox[{
      SubscriptBox[
       SuperscriptBox["Y", "*"], "lm"], "(", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}]}]}], TraditionalForm]}],
  ExpressionUUID->"2f33b9b0-4e25-4186-bca5-3b83d648e31b"],
 "\nSo the above identity also implies\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["", "s"], 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["Y", "lm"], "*"], "(", 
      RowBox[{
       RowBox[{"\[Pi]", "-", "\[Theta]"}], ",", "\[Phi]"}], ")"}]}], "=", 
    RowBox[{
     SubscriptBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "l"], "s"], 
     RowBox[{
      SubscriptBox["Y", 
       RowBox[{"l", "-", "m"}]], "(", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "080b5329-2fc8-4ead-87e4-171b4078c7a1"]
}], "Text",
 CellChangeTimes->{{3.865069727310938*^9, 
  3.865070261388266*^9}},ExpressionUUID->"c4ce0c01-b069-4224-98aa-\
e660db4fdcc4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{"Y", "[", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "\[ScriptL]", ",", "m", ",", 
           RowBox[{"\[Pi]", "-", "\[Theta]"}], ",", "\[Phi]"}], "]"}], "]"}], 
        "-", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", 
          RowBox[{"(", "\[ScriptL]", ")"}]}], 
         RowBox[{"Y", "[", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "\[ScriptL]", ",", 
           RowBox[{"-", "m"}], ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}]}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Element", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[ScriptL]", ",", "m"}], "}"}], ",", "Integers"}], "]"}],
          ",", 
         RowBox[{"0", "<=", "\[Phi]", "<=", 
          RowBox[{"2", "Pi"}]}], ",", 
         RowBox[{"0", "<", "\[Theta]", "<", "Pi"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"-", "\[ScriptL]"}], ",", "\[ScriptL]"}], "}"}]}], "]"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"\[ScriptL]", ",", "0", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.86502460486585*^9, 3.865024668007707*^9}, {
  3.865024717933301*^9, 3.865024795431872*^9}, {3.865024851297359*^9, 
  3.865024870410378*^9}, {3.865024904609222*^9, 3.8650249065213614`*^9}, {
  3.865024957875951*^9, 3.865024988564584*^9}, {3.865069068442101*^9, 
  3.865069154647193*^9}, {3.8650692165150013`*^9, 3.8650692714093*^9}, {
  3.865069309251566*^9, 3.865069388599864*^9}, {3.865069453908051*^9, 
  3.865069498831029*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"0764e2e4-3f99-48e1-bdcf-d838251d748f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8650694872000933`*^9, 3.865069499708665*^9}},
 CellLabel->
  "Out[164]=",ExpressionUUID->"578b54f7-72cd-4bd2-99e9-82114c414e30"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Strain for a planar source", "Subsection",
 CellChangeTimes->{{3.865072505759656*^9, 
  3.865072535315671*^9}},ExpressionUUID->"b67b596c-89fe-46be-a873-\
77e10aae2ecd"],

Cell[TextData[{
 "For a planar source, we expect the strain of a single ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptL]", ",", 
    RowBox[{"\[LeftBracketingBar]", "m", "\[RightBracketingBar]"}]}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a303bd4c-f50d-43da-a2e9-91c629ccc35c"],
 " mode to be\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"H", "(", "t", ")"}], " ", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"A", "(", "t", ")"}], " ", 
      SubscriptBox[
       SuperscriptBox["e", 
        RowBox[{
         RowBox[{"-", "i"}], " ", 
         RowBox[{"\[CapitalPhi]", "(", "t", ")"}]}]], 
       RowBox[{"-", "2"}]], 
      RowBox[{
       SubscriptBox["Y", "lm"], "(", 
       RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"A", "(", "t", ")"}], " ", 
      SubscriptBox[
       SuperscriptBox["e", 
        RowBox[{"i", " ", 
         RowBox[{"\[CapitalPhi]", "(", "t", ")"}]}]], 
       RowBox[{"-", "2"}]], 
      RowBox[{
       SubscriptBox[
        SuperscriptBox["Y", "*"], "lm"], "(", 
       RowBox[{
        RowBox[{"\[Pi]", "-", "\[Theta]"}], ",", "\[Phi]"}], ")"}]}]}]}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f8143d63-d267-43cd-89a7-6e5770fe5e68"],
 "\nWe want to find the +/x quadratures corresponding to this."
}], "Text",
 CellChangeTimes->{{3.8650725141641912`*^9, 3.865072565665835*^9}, {
  3.865072637235375*^9, 3.865072672112445*^9}, {3.865072731295993*^9, 
  3.865072767820649*^9}, {3.865072815832675*^9, 
  3.865073017574972*^9}},ExpressionUUID->"9da5a5ab-ed82-4682-b164-\
4247cb00c365"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Hlm", "=", 
   RowBox[{
    RowBox[{"A", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[CapitalPhi]"}], "]"}], "Ylm", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"I", " ", "m", " ", "\[Phi]"}], "]"}]}], "+", " ", 
    RowBox[{"A", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"I", " ", "\[CapitalPhi]"}], "]"}], " ", "Ystarlm", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "m", " ", "\[Phi]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"ExpToTrig", "[", "Hlm", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", " ", 
      RowBox[{"Cos", "[", "\[CapitalPhi]", "]"}]}], ",", " ", 
     RowBox[{"A", " ", 
      RowBox[{"Sin", "[", "\[CapitalPhi]", "]"}]}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.865073023808238*^9, 3.865073167807384*^9}, {
  3.865073285553138*^9, 3.8650732894440804`*^9}, {3.865073446967574*^9, 
  3.865073482535818*^9}, {3.8650752146249323`*^9, 3.8650752419540663`*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"cdb8d787-0103-4190-abb8-01984eeabc49"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", " ", "Ylm", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"m", " ", "\[Phi]"}], "-", "\[CapitalPhi]"}], "]"}]}], "+", 
  RowBox[{"A", " ", "Ystarlm", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"m", " ", "\[Phi]"}], "-", "\[CapitalPhi]"}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", "A", " ", "Ylm", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"m", " ", "\[Phi]"}], "-", "\[CapitalPhi]"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", "A", " ", "Ystarlm", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"m", " ", "\[Phi]"}], "-", "\[CapitalPhi]"}], 
    "]"}]}]}]], "Output",
 CellChangeTimes->{{3.865073164729927*^9, 3.865073168152368*^9}, {
  3.865073286612298*^9, 3.865073289669072*^9}, {3.865073450202516*^9, 
  3.865073483045353*^9}, {3.86507523744425*^9, 3.865075242826653*^9}},
 CellLabel->
  "Out[191]=",ExpressionUUID->"37239ead-e8d3-4b02-b716-eda3905a2758"]
}, Open  ]],

Cell[TextData[{
 "This means that we can write\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"H", "(", "t", ")"}], " ", "=", 
          RowBox[{
           RowBox[{"A", "(", "t", ")"}], " ", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["[", 
              RowBox[{"-", "2"}]], 
             RowBox[{
              SubscriptBox["Y", "lm"], "(", 
              RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}], " ", 
             SubscriptBox[
              RowBox[{"+", " "}], 
              RowBox[{"-", "2"}]], 
             RowBox[{
              SubscriptBox[
               SuperscriptBox["Y", "*"], "lm"], "(", 
              RowBox[{
               RowBox[{"\[Pi]", "-", "\[Theta]"}], ",", "\[Phi]"}], 
              ")"}]}]}]}]}], "]"}], " ", "cos", " ", 
        RowBox[{"\[CapitalPhi]", "(", "t", ")"}]}], " ", "-", 
       RowBox[{"i", " ", 
        SubscriptBox["[", 
         RowBox[{"-", "2"}]], 
        RowBox[{
         SubscriptBox["Y", "lm"], "(", 
         RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}], " ", 
        SubscriptBox[
         RowBox[{"-", " "}], 
         RowBox[{"-", "2"}]], 
        RowBox[{
         SubscriptBox[
          SuperscriptBox["Y", "*"], "lm"], "(", 
         RowBox[{
          RowBox[{"\[Pi]", "-", "\[Theta]"}], ",", "\[Phi]"}], ")"}]}]}], 
      "]"}], " ", "sin", " ", 
     RowBox[{"\[CapitalPhi]", "(", "t", ")"}]}], "}"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d6a134fb-e521-4a0f-84c6-e24ba0ddf528"],
 "\ni.e.,\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"H", "(", "t", ")"}], " ", "=", 
    RowBox[{
     RowBox[{"A", "(", "t", ")"}], " ", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox[
         SuperscriptBox["Y", "+"], "lm"], "(", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}], "  ", "cos", " ", 
       RowBox[{"\[CapitalPhi]", "(", "t", ")"}]}], " ", "-", 
      RowBox[{"i", " ", 
       RowBox[{
        SubscriptBox[
         SuperscriptBox["Y", "\[Times]"], "lm"], "(", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}], " ", "sin", " ", 
       RowBox[{"\[CapitalPhi]", "(", "t", ")"}]}]}], "]"}]}], 
   TraditionalForm]],ExpressionUUID->"2b8e01e6-38cf-4fff-8919-8f44e84dda21"]
}], "Text",
 CellChangeTimes->{{3.865073564114655*^9, 
  3.8650738152823553`*^9}},ExpressionUUID->"92d7fdb1-f153-4e15-b478-\
76eeca62dd82"],

Cell[TextData[{
 "After factoring out the \[Phi] dependence, the Ylm\[CloseCurlyQuote]s \
should be real, i.e. ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["", 
         RowBox[{"-", "2"}]], 
        RowBox[{
         SubscriptBox["Y", "lm"], "(", 
         RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}], 
        SuperscriptBox["e", 
         RowBox[{
          RowBox[{"-", "i"}], " ", "m", " ", "\[Phi]"}]]}], "-", 
       RowBox[{
        SubscriptBox["[", 
         RowBox[{"-", "2"}]], 
        RowBox[{
         SubscriptBox["Y", "lm"], "(", 
         RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}], 
        SuperscriptBox["e", 
         RowBox[{
          RowBox[{"-", "i"}], " ", "m", " ", "\[Phi]"}]]}]}], "]"}], "*"], 
    "=", "0"}], TraditionalForm]],
  InitializationCell->True,
  FormatType->TraditionalForm,ExpressionUUID->
  "4dfecbd7-99e5-49e6-941d-534aa14c9d0e"]
}], "Text",
 CellChangeTimes->{{3.865081404566877*^9, 3.8650814212381287`*^9}, {
  3.8650815136485147`*^9, 
  3.865081579056204*^9}},ExpressionUUID->"0ffd4dc4-8b17-4646-9177-\
92957d369637"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Y", "[", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "\[ScriptL]", ",", "m", ",", "\[Theta]", 
            ",", "\[Phi]"}], "]"}], "/", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", "m", " ", "\[Phi]"}], "]"}]}], "-", " ", 
         RowBox[{"Conjugate", "[", 
          RowBox[{
           RowBox[{"Y", "[", 
            RowBox[{
             RowBox[{"-", "2"}], ",", "\[ScriptL]", ",", "m", ",", "\[Theta]",
              ",", "\[Phi]"}], "]"}], "/", 
           RowBox[{"Exp", "[", 
            RowBox[{"I", " ", "m", " ", "\[Phi]"}], "]"}]}], "]"}]}], ")"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Element", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[ScriptL]", ",", "m"}], "}"}], ",", "Integers"}], "]"}],
          ",", 
         RowBox[{"0", "<=", "\[Phi]", "<=", 
          RowBox[{"2", "Pi"}]}], ",", 
         RowBox[{"0", "<", "\[Theta]", "<", "Pi"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"-", "\[ScriptL]"}], ",", "\[ScriptL]"}], "}"}]}], "]"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"\[ScriptL]", ",", "0", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.865081435592648*^9, 3.8650814521401463`*^9}, {
  3.8650814847572327`*^9, 3.86508150809387*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"22e6df6f-a106-4980-9671-4af5053f7660"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.865081455871903*^9, 3.865081510045567*^9},
 CellLabel->
  "Out[225]=",ExpressionUUID->"c51214f2-b827-434b-86c2-61d33577abea"]
}, Open  ]],

Cell[TextData[{
 "Equivalently, the factors should always be real for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "=", "0"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "adaaac53-ef08-4248-8115-9404544b0b49"],
 ":"
}], "Text",
 CellChangeTimes->{{3.8650818408578033`*^9, 
  3.865081871818825*^9}},ExpressionUUID->"ed1f8650-c678-4215-ab71-\
e7ead521f700"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Y", "[", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "\[ScriptL]", ",", "m", ",", "\[Theta]", 
           ",", "0"}], "]"}], "-", " ", 
         RowBox[{"Conjugate", "[", 
          RowBox[{"Y", "[", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "\[ScriptL]", ",", "m", ",", "\[Theta]", 
            ",", "0"}], "]"}], "]"}]}], ")"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Element", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[ScriptL]", ",", "m"}], "}"}], ",", "Integers"}], "]"}],
          ",", 
         RowBox[{"0", "<=", "\[Phi]", "<=", 
          RowBox[{"2", "Pi"}]}], ",", 
         RowBox[{"0", "<", "\[Theta]", "<", "Pi"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"-", "\[ScriptL]"}], ",", "\[ScriptL]"}], "}"}]}], "]"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"\[ScriptL]", ",", "0", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8650818373052797`*^9, 3.865081860560837*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"03130c46-f208-4eac-be4d-ec0f32eef3fd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8650818648932047`*^9},
 CellLabel->
  "Out[228]=",ExpressionUUID->"f1994c8e-cebe-4145-813d-2c504634af29"]
}, Open  ]],

Cell["Sanity-check that the above check is indeed right", "Text",
 CellChangeTimes->{{3.8650816234905977`*^9, 
  3.865081639406636*^9}},ExpressionUUID->"00503cc0-adc7-4bc9-b4b7-\
bb3a6628866d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"a", "+", 
      RowBox[{"I", " ", "b"}]}], ")"}], "-", 
    RowBox[{"Conjugate", "[", 
     RowBox[{"a", "+", 
      RowBox[{"I", " ", "b"}]}], "]"}]}], ",", 
   RowBox[{"Element", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", "Reals"}], "]"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.86508159398314*^9, 3.8650816195997763`*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"7a28b8a8-772a-41c3-8069-7c3b72af20cb"],

Cell[BoxData[
 RowBox[{"2", " ", "\[ImaginaryI]", " ", "b"}]], "Output",
 CellChangeTimes->{{3.8650816068835506`*^9, 3.865081619842626*^9}},
 CellLabel->
  "Out[227]=",ExpressionUUID->"1ae82821-78cc-41e4-a649-cb36bb0b47a9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Specific modes", "Subsection",
 CellChangeTimes->{{3.865070277729601*^9, 
  3.86507028051194*^9}},ExpressionUUID->"662cccb4-5b28-4d46-8587-\
640b046e890e"],

Cell[CellGroupData[{

Cell["Quadrupole (22 mode)", "Subsubsection",
 CellChangeTimes->{{3.865080046397909*^9, 
  3.865080087246724*^9}},ExpressionUUID->"a79cdb46-0d67-4bf1-b1da-\
e3ff01448793"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s compute the linear polarizations for the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptL]", "=", 
    RowBox[{
     RowBox[{"\[LeftBracketingBar]", "m", "\[RightBracketingBar]"}], "=", 
     "2"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b5e060dc-5ff6-4f25-aa6e-48791143dd6a"],
 " mode."
}], "Text",
 CellChangeTimes->{{3.865080042441821*^9, 3.865080043846828*^9}, {
  3.865080090086298*^9, 
  3.865080112655863*^9}},ExpressionUUID->"5e10cb83-45eb-4b89-b615-\
cc56da94c18a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"H22", "=", 
    RowBox[{
     RowBox[{"A", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], " ", "\[CapitalPhi]"}], "]"}], 
      RowBox[{"Y", "[", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "2", ",", "2", ",", "\[Iota]", ",", 
        "\[Phi]"}], "]"}]}], "+", " ", 
     RowBox[{"A", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", "\[CapitalPhi]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{"Y", "[", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "2", ",", "2", ",", 
         RowBox[{"\[Pi]", "-", "\[Iota]"}], ",", "\[Phi]"}], "]"}], 
       "]"}]}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"H22b", " ", "=", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", ">", "0"}], ",", 
      RowBox[{"Element", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[CapitalPhi]", ",", "\[Iota]", ",", "\[Phi]"}], "}"}], ",",
         "Reals"}], "]"}]}], "}"}], ",", 
    RowBox[{"ExpToTrig", "[", 
     RowBox[{"FullSimplify", "[", "H22", "]"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.865080137617627*^9, 3.8650802777724*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"3513c0ba-43d3-4feb-ba12-0428b0e352c9"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "A", " ", 
  SqrtBox[
   FractionBox["5", "\[Pi]"]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"Cos", "[", 
       FractionBox["\[Iota]", "2"], "]"}], "4"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"4", " ", "\[Phi]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[CapitalPhi]"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       FractionBox["\[Iota]", "2"], "]"}], "4"]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", 
       FractionBox["\[Iota]", "2"], "]"}], "4"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"4", " ", "\[Phi]"}], "]"}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       FractionBox["\[Iota]", "2"], "]"}], "4"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[CapitalPhi]"}], "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"2", " ", "\[Phi]"}], "+", "\[CapitalPhi]"}], "]"}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"2", " ", "\[Phi]"}], "+", "\[CapitalPhi]"}], "]"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.865080230851729*^9, 3.865080278581428*^9}},
 CellLabel->
  "Out[201]=",ExpressionUUID->"d1d9fb61-0d78-42cd-bf93-aee2c99c1f00"]
}, Open  ]],

Cell["The plus polarization is the real part of the above:", "Text",
 CellChangeTimes->{{3.865080349594348*^9, 
  3.865080359889929*^9}},ExpressionUUID->"ff4e383f-f308-4fca-bd39-\
9c52b362c6ae"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"h22p", " ", "=", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", ">", "0"}], ",", 
      RowBox[{"Element", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[CapitalPhi]", ",", "\[Iota]", ",", "\[Phi]"}], "}"}], ",",
         "Reals"}], "]"}]}], "}"}], ",", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"Re", "[", "H22b", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.865080280744637*^9, 3.865080308026804*^9}, {
  3.865080420596526*^9, 3.8650804476247673`*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"df9a8bed-3d26-484d-96ca-e087d9cc7124"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "8"], " ", "A", " ", 
  SqrtBox[
   FractionBox["5", "\[Pi]"]], " ", 
  RowBox[{"(", 
   RowBox[{"3", "+", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "\[Iota]"}], "]"}]}], ")"}], " ", 
  RowBox[{"Cos", "[", 
   RowBox[{
    RowBox[{"2", " ", "\[Phi]"}], "-", "\[CapitalPhi]"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.8650802839884357`*^9, 3.8650803083535633`*^9}, {
  3.865080425946313*^9, 3.865080448403749*^9}},
 CellLabel->
  "Out[210]=",ExpressionUUID->"612ac172-a170-40ce-bcdc-f80945bdce13"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"h22p", "-", 
   RowBox[{
    FractionBox["1", "2"], 
    SqrtBox[
     FractionBox["5", 
      RowBox[{"4", "\[Pi]"}]]], "A", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"Cos", "[", "\[Iota]", "]"}], "2"]}], ")"}], 
    RowBox[{"Cos", "[", 
     RowBox[{"\[CapitalPhi]", "-", 
      RowBox[{"2", "\[Phi]"}]}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.865080456567824*^9, 3.865080503474485*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"829220ea-cbfd-48ab-b00d-e900da517a90"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.865080503966506*^9},
 CellLabel->
  "Out[212]=",ExpressionUUID->"7fb2621a-87f6-46ab-8665-4324b1ec3c2e"]
}, Open  ]],

Cell["The cross polarization is (minus) the imaginary part:", "Text",
 CellChangeTimes->{{3.8650803616240463`*^9, 
  3.865080370547771*^9}},ExpressionUUID->"1f05d1f4-b96a-41ef-8612-\
1730fee510ac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"h22c", " ", "=", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", ">", "0"}], ",", 
      RowBox[{"Element", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[CapitalPhi]", ",", "\[Iota]", ",", "\[Phi]"}], "}"}], ",",
         "Reals"}], "]"}]}], "}"}], ",", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"-", 
      RowBox[{"Im", "[", "H22b", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.86508031538897*^9, 3.8650803160040216`*^9}, 
   3.8650803738568697`*^9, {3.865080451598468*^9, 3.86508045356868*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"82665c2f-3935-49e6-be7f-0a08090dcd05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", "A", " ", 
  SqrtBox[
   FractionBox["5", "\[Pi]"]], " ", 
  RowBox[{"Cos", "[", "\[Iota]", "]"}], " ", 
  RowBox[{"Sin", "[", 
   RowBox[{
    RowBox[{"2", " ", "\[Phi]"}], "-", "\[CapitalPhi]"}], "]"}]}]], "Output",
 CellChangeTimes->{3.865080316353662*^9, 3.865080374190483*^9, 
  3.865080455055232*^9},
 CellLabel->
  "Out[211]=",ExpressionUUID->"375972fd-f57a-4d80-afa3-a6f44778ed4a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"h22c", "-", 
   RowBox[{
    SqrtBox[
     FractionBox["5", 
      RowBox[{"4", "\[Pi]"}]]], "A", " ", 
    RowBox[{"Cos", "[", "\[Iota]", "]"}], 
    RowBox[{"Sin", "[", 
     RowBox[{"\[CapitalPhi]", "-", 
      RowBox[{"2", "\[Phi]"}]}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.865080514148554*^9, 3.865080525378377*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"4b06b461-f075-4e6e-b271-eaec059ecb0e"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.865080526104292*^9},
 CellLabel->
  "Out[214]=",ExpressionUUID->"4bd54402-3a30-4a06-ae58-188f7396a952"]
}, Open  ]],

Cell["\<\
Check that our expression in terms of Ylm\[CloseCurlyQuote]s gives the right \
ellipticity too:\
\>", "Text",
 CellChangeTimes->{{3.8650806045653477`*^9, 
  3.8650806196024847`*^9}},ExpressionUUID->"3c6f436d-d191-4874-8ddc-\
26d00bf45710"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Epsilon]22", " ", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"Y", "[", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "2", ",", "2", ",", "\[Iota]", ",", 
         "\[Phi]"}], "]"}], "]"}], "-", 
      RowBox[{"Abs", "[", 
       RowBox[{"Y", "[", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "2", ",", 
         RowBox[{"-", "2"}], ",", "\[Iota]", ",", "\[Phi]"}], "]"}], "]"}]}], 
     
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"Y", "[", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "2", ",", "2", ",", "\[Iota]", ",", 
         "\[Phi]"}], "]"}], "]"}], "+", 
      RowBox[{"Abs", "[", 
       RowBox[{"Y", "[", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "2", ",", 
         RowBox[{"-", "2"}], ",", "\[Iota]", ",", "\[Phi]"}], "]"}], "]"}]}]],
     ",", 
    RowBox[{"Element", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Iota]", ",", "\[Phi]"}], "}"}], ",", "Reals"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.865080634130747*^9, 3.865080686765876*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"e857a103-05aa-4236-adf3-19597304ca82"],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", 
   RowBox[{"Cos", "[", "\[Iota]", "]"}]}], 
  RowBox[{"3", "+", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "\[Iota]"}], "]"}]}]]], "Output",
 CellChangeTimes->{{3.865080659830552*^9, 3.865080688641952*^9}},
 CellLabel->
  "Out[218]=",ExpressionUUID->"aa6f5d46-42e0-4b82-86c2-13755db3bfd6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"\[Epsilon]22", "-", 
   FractionBox[
    RowBox[{"2", 
     RowBox[{"Cos", "[", "\[Iota]", "]"}]}], 
    RowBox[{"1", " ", "+", " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", "\[Iota]", "]"}], "2"]}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.865080691209364*^9, 3.865080716663026*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"46927561-b784-4f66-b22d-9841279b3786"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.865080713338628*^9, 3.865080716909297*^9}},
 CellLabel->
  "Out[220]=",ExpressionUUID->"7679391e-2840-45fd-a919-1f39a759977e"]
}, Open  ]],

Cell["\<\
In the above, Mathematica likes to use the following identity:\
\>", "Text",
 CellChangeTimes->{{3.865080771796076*^9, 
  3.86508078355805*^9}},ExpressionUUID->"2fc1954a-a0d0-42e8-a7f0-\
3b7ac15e59a3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrigReduce", "[", 
  RowBox[{
   RowBox[{"Cos", "[", "\[Iota]", "]"}], "^", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.865080739399334*^9, 3.865080791983921*^9}},
 CellLabel->
  "In[223]:=",ExpressionUUID->"9818eea9-491c-4b62-bfbf-a4258c4b06fa"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "\[Iota]"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8650807457383757`*^9, 3.865080761937834*^9}, 
   3.8650807925983543`*^9},
 CellLabel->
  "Out[223]=",ExpressionUUID->"0e8b193c-d1de-42b1-8592-f05e2c1f40a3"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{878, 847},
WindowMargins->{{Automatic, 166}, {Automatic, 1}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (May 11, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0cf676fb-0e96-4322-823f-2e3f0485f009"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 203, 3, 67, "Section",ExpressionUUID->"c24cfee6-221e-468b-9392-19d6a58507ee"],
Cell[786, 27, 194, 3, 35, "Text",ExpressionUUID->"68d761c8-5fbc-4aec-b2ca-e7f793cd1e73"],
Cell[983, 32, 2424, 73, 114, "Input",ExpressionUUID->"74cf56f8-cd54-45ac-8c67-9c48f263b519"],
Cell[CellGroupData[{
Cell[3432, 109, 290, 7, 30, "Input",ExpressionUUID->"04b7e5d1-ea96-4d97-911a-fece8a5f3ba2"],
Cell[3725, 118, 430, 12, 57, "Output",ExpressionUUID->"d6096972-5bdd-437b-80c9-b48b02e0030d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4192, 135, 160, 3, 54, "Subsection",ExpressionUUID->"43e3b16f-7276-4e14-94e2-5a36963e6630"],
Cell[4355, 140, 938, 29, 58, "Text",ExpressionUUID->"634825e3-4b70-4a8a-bc29-4663203d17ec"],
Cell[CellGroupData[{
Cell[5318, 173, 1882, 48, 52, "Input",ExpressionUUID->"78d0ac19-4bbe-4727-b3be-0afd27f82bc4"],
Cell[7203, 223, 784, 21, 56, "Output",ExpressionUUID->"736162cd-7128-4686-8792-8c5d138fafee"]
}, Open  ]],
Cell[8002, 247, 4151, 135, 180, "Text",ExpressionUUID->"c4ce0c01-b069-4224-98aa-e660db4fdcc4"],
Cell[CellGroupData[{
Cell[12178, 386, 1867, 48, 52, "Input",ExpressionUUID->"0764e2e4-3f99-48e1-bdcf-d838251d748f"],
Cell[14048, 436, 810, 21, 56, "Output",ExpressionUUID->"578b54f7-72cd-4bd2-99e9-82114c414e30"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14907, 463, 174, 3, 54, "Subsection",ExpressionUUID->"b67b596c-89fe-46be-a873-77e10aae2ecd"],
Cell[15084, 468, 1631, 47, 81, "Text",ExpressionUUID->"9da5a5ab-ed82-4682-b164-4247cb00c365"],
Cell[CellGroupData[{
Cell[16740, 519, 1159, 31, 52, "Input",ExpressionUUID->"cdb8d787-0103-4190-abb8-01984eeabc49"],
Cell[17902, 552, 955, 23, 34, "Output",ExpressionUUID->"37239ead-e8d3-4b02-b716-eda3905a2758"]
}, Open  ]],
Cell[18872, 578, 2491, 73, 104, "Text",ExpressionUUID->"92d7fdb1-f153-4e15-b478-76eeca62dd82"],
Cell[21366, 653, 1148, 35, 38, "Text",ExpressionUUID->"0ffd4dc4-8b17-4646-9177-92957d369637"],
Cell[CellGroupData[{
Cell[22539, 692, 1612, 44, 52, "Input",ExpressionUUID->"22e6df6f-a106-4980-9671-4af5053f7660"],
Cell[24154, 738, 806, 21, 56, "Output",ExpressionUUID->"c51214f2-b827-434b-86c2-61d33577abea"]
}, Open  ]],
Cell[24975, 762, 380, 11, 35, "Text",ExpressionUUID->"ed1f8650-c678-4215-ab71-e7ead521f700"],
Cell[CellGroupData[{
Cell[25380, 777, 1303, 36, 52, "Input",ExpressionUUID->"03130c46-f208-4eac-be4d-ec0f32eef3fd"],
Cell[26686, 815, 786, 21, 56, "Output",ExpressionUUID->"f1994c8e-cebe-4145-813d-2c504634af29"]
}, Open  ]],
Cell[27487, 839, 193, 3, 35, "Text",ExpressionUUID->"00503cc0-adc7-4bc9-b4b7-bb3a6628866d"],
Cell[CellGroupData[{
Cell[27705, 846, 550, 17, 30, "Input",ExpressionUUID->"7a28b8a8-772a-41c3-8069-7c3b72af20cb"],
Cell[28258, 865, 223, 4, 34, "Output",ExpressionUUID->"1ae82821-78cc-41e4-a649-cb36bb0b47a9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28530, 875, 161, 3, 54, "Subsection",ExpressionUUID->"662cccb4-5b28-4d46-8587-640b046e890e"],
Cell[CellGroupData[{
Cell[28716, 882, 171, 3, 45, "Subsubsection",ExpressionUUID->"a79cdb46-0d67-4bf1-b1da-e3ff01448793"],
Cell[28890, 887, 549, 15, 35, "Text",ExpressionUUID->"5e10cb83-45eb-4b89-b615-cc56da94c18a"],
Cell[CellGroupData[{
Cell[29464, 906, 1311, 37, 73, "Input",ExpressionUUID->"3513c0ba-43d3-4feb-ba12-0428b0e352c9"],
Cell[30778, 945, 1440, 43, 81, "Output",ExpressionUUID->"d1d9fb61-0d78-42cd-bf93-aee2c99c1f00"]
}, Open  ]],
Cell[32233, 991, 194, 3, 35, "Text",ExpressionUUID->"ff4e383f-f308-4fca-bd39-9c52b362c6ae"],
Cell[CellGroupData[{
Cell[32452, 998, 641, 17, 30, "Input",ExpressionUUID->"df9a8bed-3d26-484d-96ca-e087d9cc7124"],
Cell[33096, 1017, 548, 15, 57, "Output",ExpressionUUID->"612ac172-a170-40ce-bcdc-f80945bdce13"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33681, 1037, 578, 17, 57, "Input",ExpressionUUID->"829220ea-cbfd-48ab-b00d-e900da517a90"],
Cell[34262, 1056, 153, 3, 34, "Output",ExpressionUUID->"7fb2621a-87f6-46ab-8665-4324b1ec3c2e"]
}, Open  ]],
Cell[34430, 1062, 197, 3, 35, "Text",ExpressionUUID->"1f05d1f4-b96a-41ef-8612-1730fee510ac"],
Cell[CellGroupData[{
Cell[34652, 1069, 686, 18, 30, "Input",ExpressionUUID->"82665c2f-3935-49e6-be7f-0a08090dcd05"],
Cell[35341, 1089, 462, 13, 57, "Output",ExpressionUUID->"375972fd-f57a-4d80-afa3-a6f44778ed4a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35840, 1107, 473, 13, 57, "Input",ExpressionUUID->"4b06b461-f075-4e6e-b271-eaec059ecb0e"],
Cell[36316, 1122, 153, 3, 34, "Output",ExpressionUUID->"4bd54402-3a30-4a06-ae58-188f7396a952"]
}, Open  ]],
Cell[36484, 1128, 249, 6, 35, "Text",ExpressionUUID->"3c6f436d-d191-4874-8ddc-26d00bf45710"],
Cell[CellGroupData[{
Cell[36758, 1138, 1217, 36, 51, "Input",ExpressionUUID->"e857a103-05aa-4236-adf3-19597304ca82"],
Cell[37978, 1176, 342, 9, 52, "Output",ExpressionUUID->"aa6f5d46-42e0-4b82-86c2-13755db3bfd6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38357, 1190, 427, 11, 51, "Input",ExpressionUUID->"46927561-b784-4f66-b22d-9841279b3786"],
Cell[38787, 1203, 177, 3, 34, "Output",ExpressionUUID->"7679391e-2840-45fd-a919-1f39a759977e"]
}, Open  ]],
Cell[38979, 1209, 211, 5, 35, "Text",ExpressionUUID->"2fc1954a-a0d0-42e8-a7f0-3b7ac15e59a3"],
Cell[CellGroupData[{
Cell[39215, 1218, 272, 6, 30, "Input",ExpressionUUID->"9818eea9-491c-4b62-bfbf-a4258c4b06fa"],
Cell[39490, 1226, 361, 10, 50, "Output",ExpressionUUID->"0e8b193c-d1de-42b1-8592-f05e2c1f40a3"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

